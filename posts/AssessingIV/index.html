<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Giovanni Forchini">
<meta name="dcterms.date" content="2020-03-01">

<title>Giovanni Forchini - Assessing IV models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Giovanni Forchini</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../bio.html" rel="" target="">
 <span class="menu-text">Short CV</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto tools-wide">
    <a href="https://www.linkedin.com/in/giovanni-forchini-77452794/" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-linkedin"></i></a>
    <a href="https://twitter.com/gforchini" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/gforchini" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Assessing IV models</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Giovanni Forchini </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 1, 2020</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>Endogeneity is a big problem in econometric modelling and as such it is usually treated extensively in intermediate/advanced econometric courses at master level. In my lectures I tend to emphasis the importance of using theory to make informed choices.</p>
<p>In the limited information approach one specifies a structural equation of the form</p>
<p><span class="math display">\[y_{1i}=y_{2i} \beta + z_{1i}\gamma+u_i\]</span></p>
<p>with a corresponding reduced form for the explanatory endogenous variables <span class="math inline">\(y_2\)</span> - often referred to as the first stage regression by applied economists -</p>
<p><span class="math display">\[y_{2i}=z_{1i} \Pi_{1} +z_{2i} \Pi_{2} +v_i.\]</span></p>
<p>In my notation the <span class="math inline">\(y\)</span>s denote the endogenous variables and the <span class="math inline">\(z\)</span>s the exogenous variables of which <span class="math inline">\(z_{2i}\)</span> is the vector of instruments. The observables have the following dimensions: <span class="math inline">\(y_{2i}\)</span> is <span class="math inline">\(1 \times p\)</span>, <span class="math inline">\(z_{1i}\)</span> is <span class="math inline">\(1 \times k_1\)</span> and <span class="math inline">\(z_{2i}\)</span> is <span class="math inline">\(1 \times k_2\)</span></p>
<p>The structural parameters can be estimated using instrumental variables methods. The estimation methods do not pose many problems for the students but the assessment of the reliability of the model estimated sometimes does. Assume that <span class="math inline">\(y_{2i}\)</span> is one-dimensional to avoid complications (will make a few comments only about the general case).</p>
<p>The problem is: how well can one trust the estimated model?</p>
<p>Three tests are usually employed by econometricians to this purpose: a test for endogeneity, a test for strength of the instruments and a test for over-identification. These need to be performed in a certain order to be informative.</p>
<section id="testing-the-strength-of-the-instruments" class="level1">
<h1>Testing the strength of the instruments</h1>
<p>The structural parameters are identified if <span class="math inline">\(\Pi_2\)</span> has full column rank - in the lectures we usually look at this from a couple of different points of view. Testing that <span class="math inline">\(\Pi_2\)</span> has full column rank is essentially testing for identification. This is the starting point of the evaluation because if the structural parameters are not identified there is no point in assessing whether they can be estimated well - because they cannot be estimated at all.</p>
<p>In the case where there is only one endogenous variables among the regressors, <span class="math inline">\(\Pi_2\)</span> has full column rank if it is not a zero vector. So in order to assess the identification of the model one can test <span class="math inline">\(H_0: \Pi_2=0\)</span> versus <span class="math inline">\(H_1: \Pi_2\ne 0\)</span>. This can be done using an <span class="math inline">\(F\)</span> test in the first stage regression. However, one does not usually use the classical critical values because weak instruments may also cause problems similar to those caused by lack of identification. One has to be a bit more conservative. Staiger and Stock (Econometrica, 1997) have suggested a rule of thumb:</p>
<blockquote class="blockquote">
<p>If <span class="math inline">\(F &gt;10\)</span> conclude that the instruments satisfy the classical assumptions and are thus well behaved; however if <span class="math inline">\(F&lt;10\)</span> than weak instruments may be present invalidating any kind of asymptotic inference.</p>
</blockquote>
<p>This is a crude rule of thumb and has been improved in more recent work. Notice that if there is more than one endogenous variables among the regressors, the F statistics need to be replaced by a multivariate version (usually the Cragg-Donald statistic which is used to test the rank of <span class="math inline">\(\Pi_2\)</span>).</p>
<p>The reason why this test is performed first is that the condition <span class="math inline">\(\Pi_2\)</span> has full rank is necessary and sufficient for the various estimators of the structural parameters to be informative and for various statistics to have standard distributions. Unless there is clear evidence that <span class="math inline">\(\Pi_2\)</span> has full rank and is bounded away from zero, the asymptotic of most statistics - including the endogeneity and overidentification tests discussed below - breaks down.</p>
</section>
<section id="testing-endogeneity" class="level1">
<h1>Testing endogeneity</h1>
<p>If the model passes the previous hurdle, one should then test for endogeneity. This is normally done using the Hausman test - which is not robust to heteroskedasticity - or more often the Wu test - as this can be robustified to heteroskedasticity.</p>
<p>Once one conditions on the exogenous variables, including the instruments, the correlation between <span class="math inline">\(y_{2i}\)</span> and <span class="math inline">\(u_i\)</span> is the same as the correlation between <span class="math inline">\(u_i\)</span> and <span class="math inline">\(v_i\)</span>. Once can think of modelling it as <span class="math inline">\(u_i=v_i \gamma+\varepsilon_i\)</span>. If <span class="math inline">\(v_i\)</span> were observable we could test for endogeneity by testing<span class="math inline">\(H_0:\eta=0\)</span> in<span class="math inline">\(y_{1i}=y_{2i} \beta + z_{1i}\gamma+ v_i \eta +\varepsilon_i.\)</span></p>
<p>To overcome the fact that <span class="math inline">\(v_i\)</span> is not observable, the Wu test is implemented as follows:</p>
<p>first one estimates the first stage regression using OLS and calculate the residuals <span class="math inline">\(\hat v_i\)</span>; the residuals are inserted into the structural equation which is now estimated using OLS <span class="math inline">\(y_{1i}=y_{2i} \beta + z_{1i}\gamma+\hat v_i \eta +\varepsilon_i;\)</span> and finally one tests whether the F test on the coefficients of these reduced form residuals is significant.</p>
<p>Despite what its name suggests, the null hypothesis is that these coefficients are zero, that is <span class="math inline">\(y_{2i}\)</span> is exogenous - versus the alternative that they are not - <span class="math inline">\(y_{2i}\)</span> is endogenous.</p>
<p>Notice that the first stage regression is important in testing for endogeneity, too. If it shows that the instruments are weak, the reliability is this test is undermined. In the special case where <span class="math inline">\(\Pi_2=0\)</span>,<span class="math inline">\(y_{2i}=z_{1i} \hat \Pi_1 +\hat v_i\)</span>, so that the model in 2 has perfect multicollinearity. Similar problem arise when <span class="math inline">\(\Pi_2\)</span> has rank less than the number of right-hand-side endogenous variables.</p>
</section>
<section id="testing-overidentifying-restrictions" class="level1">
<h1>Testing overidentifying restrictions</h1>
<p>These are test for the null hypothesis that $H_0:E(u_i )=0 $ against $H_1:E(u_i ) $. It is sometimes called an orthogonality test. A previous entry discusses the different types of tests for over-identification that one can have.</p>
<p>A test is based on the sample counterpart of <span class="math inline">\(E\left( \left[ z_{1i},z_{2i}\right]u_i \right)\)</span>:</p>
<p><span class="math display">\[\frac{1}{N} \sum_{i=1}^N z_i u_i .\]</span></p>
<p>Notice if the orthogonality condition fails <span class="math inline">\(\frac{1}{N} \sum_{i=1}^N z_i u_i \to^P \sigma_{zu}\)</span> but if it holds <span class="math inline">\(\frac{1}{N} \sum_{i=1}^N z_i u_i \to^P 0\)</span>.</p>
<p>Obviously one cannot base a test on this because the errors are not observed. However, one can replace the errors with the TSLS residuals and consider the statistic $m= _{i=1}^N z_i u_i $ instead. One can show that under some regularity conditions</p>
<p><span class="math display">\[\sqrt{N} \bar m \to^D N\left( 0, Asy.Cov(\bar m)\right)\]</span></p>
<p>and that once can find an estimator of <span class="math inline">\(Asy.Cov(\bar m)\)</span>. Thus a Wald test can be based on:</p>
<p><span class="math display">\[N \bar m ' \left( \widehat{ Asy.Cov(\bar m) }\right) ^{-1}\bar m \to \chi _{k_{z_2}-p}^2\]</span></p>
<p>where <span class="math inline">\(\widehat{ Asy.Cov(\bar m) }= \frac{1}{N} \sum_{i=1}^N \hat u_i^2 z_i z_i'\)</span>.</p>
<p>Notice that among the regularity conditions mentioned above include the assumption that the parameters of the model are identified so that the rank of <span class="math inline">\(\Pi_2\)</span> is <span class="math inline">\(p\)</span>. If <span class="math inline">\(\Pi_2\)</span> is rank deficient the distribution of <span class="math inline">\(N \bar m ' \left( \widehat{ Asy.Cov(\bar m) }\right) ^{-1}\bar m\)</span> will not converge to a <span class="math inline">\(\chi _{k_{z_2}-p}^2\)</span> but to some other distribution.Finally notice in order to be able to perform this test one requires <span class="math inline">\(k_{z_2}-p \ge 1\)</span>.</p>
</section>
<section id="final-remarks" class="level1">
<h1>Final remarks</h1>
<p>For the reasons outlined above, one usually perform the three tests in the following order: (1) Test for the strength of the instruments; (2) Test of endogeneity and (3) tests for over identification.</p>
<p>If the test for the strength of the instruments indicates problems we need to doubt the validity of the subsequent tests.</p>
<p>If the instruments are good, but the second tests indicate that te potentially endogenous variables are in fact exogenous, one really needs to think very carefully about what to do next. It may be that the economic theory on the basis of which endogeneity is suspected may be wrong. Or it may be that some other assumptions made is wrong. So think carefully about the validity of the assumptions.</p>
<p>If the first two tests are passed but overidentification fails, one needs once again to think about what goes wrong. Are the instruments really exogenous? Is the model well specified?</p>
<p>Thinking is fundamental …</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>