[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Welcome to my blog",
    "section": "",
    "text": "Here you will find my random thoughts on various aspects of econometrics and statistics and more …\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nData sources\n\n\n\n\n\n\n\n\n\n\n\nSep 15, 2025\n\n\nGiovanni Forchini\n\n\n\n\n\n\n\n\n\n\n\n\nTeaching econometrics: R or Stata?\n\n\n\n\n\n\n\n\n\n\n\nOct 9, 2023\n\n\nGiovanni Forchini\n\n\n\n\n\n\n\n\n\n\n\n\nComputing exact distributions part 4\n\n\n\n\n\n\n\n\n\n\n\nSep 18, 2023\n\n\nGiovanni Forchini\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/RvsStata/index.html",
    "href": "posts/RvsStata/index.html",
    "title": "Teaching econometrics: R or Stata?",
    "section": "",
    "text": "Last year we decided to switch from Stata to R in our Master program. This has had huge problem for the Econometrics 1 course that I teach. Econometrics 1 is an introduction to microeconometrics for economists, covering linear regression model, heteroskedasticity, panel data and endogeneity/instrumental variables.\nFirst the positives. R is powerful and actively develop by lots of groups and individuals. It is at the forefront of statistics, data analytics and machine learning. Some packages are just wonderful. But … Stata is easier to use for teaching econometrics.\nFor example, econometricians tend to correct the standard errors to make them robust to heteroskedasticity. This is accomplish in Stata with a simple command:\nregress y x1 x2 x3, robust\nThis is easy and intuitive and I can focus on the theory underlying this command. In R, this becomes:\nreg &lt;- lm(‘y~x1+x2+x3’,data)\nlibrary(sandwich)\nrobust_cov &lt;- vcovHC(reg, type = “HC1”)\nlibrary(lmtest)\ncoeftest(reg, vcov = robust_cov)\nAnd if I want a clean table,\nlibrary(stargazer)\nrobust_se &lt;- sqrt(diag(robust_cov))\nstargazer(reg, type = “text”,se = list(robust_se))"
  },
  {
    "objectID": "posts/Datasources/index.html",
    "href": "posts/Datasources/index.html",
    "title": "Data sources",
    "section": "",
    "text": "Here is a list of possible data sources that can be useful for a master thesis in economics.\nhttps://www.europeansocialsurvey.org/\nhttps://ec.europa.eu/eurostat/web/microdata\nhttps://www.enterprisesurveys.org/en/enterprisesurveys\nhttps://www.pdrc.keio.ac.jp/pdrc/ja/\nhttps://www.ipums.org/\nhttps://data-explorer.oecd.org/\nhttps://www.statistikdatabasen.scb.se/pxweb/sv/ssd/\nhttps://simba.isr.umich.edu/data/data.aspx\nhttps://www.bls.gov/cex/pumd.htm\nhttps://ei.se/om-oss/statistik-och-oppna-data\nhttps://www.isss.pku.edu.cn/cfps/en/index.htm\nhttps://share-eric.eu/data/data-set-details/easyshare\nhttps://data.worldbank.org/\nhttps://stat.unido.org/\nhttps://comtradeplus.un.org/\nhttps://www.nber.org/research/data?page=1&perPage=50\nhttps://www.lisdatacenter.org/\nhttps://ghdx.healthdata.org/\nhttps://gss.norc.org/\nhttp://catalog.ihsn.org/catalog/?page=1&ps=15\nhttps://dhsprogram.com/Data/\nhttps://data.unicef.org/\nhttps://www.ons.gov.uk/economy/datalist?filter=datasets\nhttps://ukdataservice.ac.uk/find-data/browse/economics/\nhttps://psidonline.isr.umich.edu/\nhttps://fred.stlouisfed.org/\nhttps://www.bls.gov/cex/data.htm\nDatastream (training at https://www.refinitiv.com/en/learning-centre/learning-catalogue?q=datastream&page=1)\nhttps://www.kaggle.com/datasets\nhttps://hfi.se/working-papers/ HFI, the Swedish retail research institute offers free access for students to the Nielsen database (aggregated retail data, prices, quantities, product characteristics). The downside is that retrieving the data requires you to travel to their offices in Stockholm, and the interface for extracting the data is not very user friendly.\nhttps://www.omsystembolaget.se/foretagsfakta/systembolaget-i-siffror/forsaljningsstatistik/ Systembolaget publishes yearly statistics on their sales. Scroll down to “årsrapporter” where they have yearly excel files on article level (price, quantity sold that year, characteristics (organic etc)).\nhttps://www.bankofengland.co.uk/working-paper/2023/measuring-monetary-policy-in-the-uk-ukmpd?utm_source=Bank+of+England+updates&utm_campaign=3baab217f5-EMAIL_CAMPAIGN_2023_11_10_02_17&utm_medium=email&utm_term=0_-3baab217f5-%5BLIST_EMAIL_ID%5D Monetary policy event study database from Bank of England\nhttps://monitoringthefuture.org/\nhttps://www.acha.org/NCHA/NCHA_Home\nhttps://www.cdc.gov/healthyyouth/data/yrbs/index.htm\nhttps://www.cdc.gov/nchs/nhis/index.htm\nhttps://data.census.gov/\nhttps://www.ons.gov.uk/census\nPenn World Table: https://pwt-data-tool.streamlit.app/\nhttps://r2rsquaredlse.github.io/web-historicalexpectations/ Dataset on Measures of US Expected Inflation before 1978\nhttps://eh.net/databases/\nhttps://clio-infra.eu/index.html\nhttps://www.lusem.lu.se/organisation/department-economic-history/research-department-economic-history/databases-department-economic-history"
  },
  {
    "objectID": "posts/CED4/index.html",
    "href": "posts/CED4/index.html",
    "title": "Computing exact distributions part 4",
    "section": "",
    "text": "It may be difficult to calculate Jacobians as the determinant of matrices of derivatives, especially when one has many variables. However, there is an alternative method based on the exterior product which may be useful in some cases. This approach is covered in this post.\nWhen one transforms \\(x\\) to \\(y\\) according to \\(x = x\\left( y \\right)\\), every component of \\(x\\) is transformed as follows \\({x_i} = {x_i}\\left( {{y_1},{y_2},...{y_n}} \\right)\\). So the differential of \\({x_i}\\) is \\[d{x_i} = \\frac{{\\partial {x_i}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_i}}}{{\\partial {y_2}}}d{y_2} + ... + \\frac{{\\partial {x_i}}}{{\\partial {y_n}}}d{y_n}\\] for i=1,2,…,n. I now consider the quantities \\(d{x_i}\\), i=1,2,…,n, and define a product (or more precisely the exterior product or wedge product) by two rules\n\nmultilinearity \\[d{x_i} \\wedge \\left( {ad{x_j} + bd{x_k}} \\right) = a\\left( {d{x_i} \\wedge d{x_j}} \\right) + b\\left( {d{x_i} \\wedge d{x_k}} \\right)\\] and \\[\\left( {ad{x_j} + bd{x_k}} \\right) \\wedge d{x_i} = a\\left( {d{x_j} \\wedge d{x_i}} \\right) + b\\left( {d{x_k} \\wedge d{x_i}} \\right)\\]\nand skew-symmetry \\[d{x_i} \\wedge d{x_j} =  - d{x_j} \\wedge d{x_i}\\] i.e. if the order of two terms is reversed, the product changes sign.\n\nNotice that when I write \\(d{x_1}d{x_2,}....d{x_n}\\) I really mean \\(d{x_1} \\wedge d{x_2} \\wedge .... \\wedge d{x_n}\\). If follows from the property of skew-symmetry that \\[d{x_i} \\wedge d{x_i} =  - d{x_i} \\wedge d{x_i}\\] i.e.\\(d{x_i} \\wedge d{x_i} = 0.\\)\nAn important result is the following one. If \\[d{x_i} = \\frac{{\\partial {x_i}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_i}}}{{\\partial {y_2}}}d{y_2} + ... + \\frac{{\\partial {x_i}}}{{\\partial {y_n}}}d{y_n}\\] for \\(i=1,2,…,n\\), and I let \\[d{x_1} \\wedge d{x_2} \\wedge d{x_3} \\wedge .... \\wedge d{x_n} = J\\left( {x \\to y} \\right)\\left( {d{y_1} \\wedge d{y_2} \\wedge d{y_3} \\wedge .... \\wedge d{y_n}} \\right),\\] so that this method is equivalent to the one considered before.\nI will not prove this, but I will go through an example instead. Suppose that \\(n=3\\), so that I need to deal with \\(d{x_1} \\wedge d{x_2} \\wedge d{x_3}\\) only, and \\[\\begin{array}{l}\nd{x_1} = \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}d{y_3}\\\\\nd{x_2} = \\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_3}\\\\\nd{x_3} = \\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}\n\\end{array}\\] Then \\[\\begin{array}{c}\nd{x_1} \\wedge d{x_2} \\wedge d{x_3} = \\left( {\\frac{{\\partial {x_1}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}d{y_3}} \\right) \\wedge \\\\\n\\left( {\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_3}} \\right) \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n= \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}d{y_1} \\wedge \\left( {\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_3}} \\right) \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}d{y_2} \\wedge \\left( {\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_3}} \\right) \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}d{y_3} \\wedge \\left( {\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_3}} \\right) \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\n\\end{array}\\] because of the property of multilinearity. \\[\\begin{array}{c}\nd{x_1} \\wedge d{x_2} \\wedge d{x_3} = \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_1} \\wedge d{y_1} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_1} \\wedge d{y_2} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_1} \\wedge d{y_3} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_2} \\wedge d{y_1} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_2} \\wedge d{y_2} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_2} \\wedge d{y_3} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_3} \\wedge d{y_1} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_3} \\wedge d{y_2} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_3} \\wedge d{y_3} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\n\\end{array}\\] Again, this follows from multilinearity. Notice that some terms are zero because \\(d{y_i} \\wedge d{y_i} = 0\\), \\[\\begin{array}{c}\nd{x_1} \\wedge d{x_2} \\wedge d{x_3} = \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_1} \\wedge d{y_2} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_1} \\wedge d{y_3} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_2} \\wedge d{y_1} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_2} \\wedge d{y_3} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_3} \\wedge d{y_1} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_3} \\wedge d{y_2} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\n\\end{array}\\]\nThings simplify even more. I will focus on the first term \\[\\begin{array}{l}\n\\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_1} \\wedge d{y_2} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n= \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} \\wedge d{y_2} \\wedge d{y_1}\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_1} \\wedge d{y_2} \\wedge d{y_2}\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_1} \\wedge d{y_2} \\wedge d{y_3}\n\\end{array}\\]\nNow \\[d{y_1} \\wedge d{y_2} \\wedge d{y_1} =  - d{y_1} \\wedge d{y_1} \\wedge d{y_2}\\] because of skew-symmetry. But \\(d{y_1} \\wedge d{y_1} = 0\\), so that \\[d{y_1} \\wedge d{y_2} \\wedge d{y_1} =  - d{y_1} \\wedge d{y_1} \\wedge d{y_2} = 0.\\]\nIn general, if there are two terms which are the same the outer product is zero. So \\[\\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_1} \\wedge d{y_2} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right) = \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_1} \\wedge d{y_2} \\wedge d{y_3}.\\]\nUsing the same reasoning it is easy to show that \\[\\begin{array}{c}\n\\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_1} \\wedge d{y_3} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right) =  - \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}\\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_1} \\wedge d{y_3} \\wedge d{y_3}\\\\\n\\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_2} \\wedge d{y_1} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right) = \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}\\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_2} \\wedge d{y_1} \\wedge d{y_3}\\\\\n=  - \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}\\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_1} \\wedge d{y_2} \\wedge d{y_3}\\\\\n\\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_2} \\wedge d{y_3} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right) = \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} \\wedge d{y_2} \\wedge d{y_3}\\\\\n\\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_3} \\wedge d{y_1} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right) = \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}\\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_1} \\wedge d{y_2} \\wedge d{y_3}\\\\\n\\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_3} \\wedge d{y_2} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right) = \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_3} \\wedge d{y_2} \\wedge d{y_1}\\\\\n=  - \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_3} \\wedge d{y_1} \\wedge d{y_2}\\\\\n= \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} \\wedge d{y_3} \\wedge d{y_2}\\\\\n=  - \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} \\wedge d{y_2} \\wedge d{y_3}\n\\end{array}\\]\nPutting everything together \\[\\begin{array}{l}\nd{x_1} \\wedge d{x_2} \\wedge d{x_3}\\\\\n= \\left[ {\\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_3}}} - \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}\\frac{{\\partial {x_3}}}{{\\partial {y_3}}} - \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}\\frac{{\\partial {x_3}}}{{\\partial {y_3}}} + \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}\\frac{{\\partial {x_3}}}{{\\partial {y_1}}} + \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}\\frac{{\\partial {x_3}}}{{\\partial {y_2}}} - \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}} \\right]d{y_1} \\wedge d{y_2} \\wedge d{y_3}\n\\end{array}\\]\nThe complicated thing in square brackets is \\(J\\left( {x \\to y} \\right)\\). So \\[d{x_1} \\wedge d{x_2} \\wedge d{x_3} = J\\left( {x \\to y} \\right)d{y_1} \\wedge d{y_2} \\wedge d{y_3}.\\] This can be rewritten as \\[\\left( {dx} \\right) = J\\left( {x \\to y} \\right)\\left( {dy} \\right)\\] where \\(\\left( {dx} \\right) = d{x_1} \\wedge d{x_2} \\wedge d{x_3}\\) and \\(\\left( {dy} \\right) = d{y_1} \\wedge d{y_2} \\wedge d{y_3}\\). Sometimes the notation \\(d{x_1} \\wedge d{x_2} \\wedge d{x_3} \\wedge ... \\wedge d{x_n} = \\mathop \\wedge \\limits_{i = 1}^n d{x_i}\\) is used. The quantity \\(\\left( {dx} \\right) = \\mathop \\wedge \\limits_{i = 1}^n d{x_i}\\) is called the volume element.\nExample 1. Let \\({q_1}\\sim{\\chi ^2}\\left( {{v_1}} \\right)\\) and \\({q_2}\\sim{\\chi ^2}\\left( {{v_2}} \\right)\\) be independent random variables. Suppose I transform variables as \\({q_1} = fq\\) and \\({q_2} = q\\) (i.e. \\(f = {q_1}/{q_2}\\)). What is the Jacobian of this transformation? To find it, I need to calculate the differentials \\[\\begin{array}{l}\nd{q_1} = qdf + fdq\\\\\nd{q_2} = dq\n\\end{array}\\] so \\[d{q_1} \\wedge d{q_2} = \\left( {qdf + fdq} \\right) \\wedge dq = q\\left( {df \\wedge dq} \\right).\\]\nExercise 2. Let \\(x\\) be an \\(n \\times 1\\) vector then I denote \\[\\left( {dx} \\right) = d{x_1} \\wedge d{x_2} \\wedge d{x_3} \\wedge ... \\wedge d{x_n} = \\mathop  \\wedge \\limits_{i = 1}^n d{x_i}\\] (note the order of the elements of the product). Suppose I set \\(x = Ay\\) where \\(A\\) is an \\(n \\times n\\) non-singular matrix. Then, I have \\(\\left( {dx} \\right) = \\left| A \\right|\\left( {dy} \\right)\\).\nExample 3. Let \\(S &gt; 0\\) be a positve definite matrix of dimension \\((k + 1 \\times k + 1)\\). Partition is as \\[S = \\left( {\\begin{array}{*{20}{c}}\n{{S_{11}}}&{{S_{21}}'}\\\\\n{{S_{21}}}&{{S_{22}}}\n\\end{array}} \\right)\\] where \\({S_{11}}\\) is \\(1 \\times 1\\), \\({S_{22}}\\) is \\(k \\times k\\) and \\({S_{21}}\\) is \\(k \\times 1\\). Let \\[\\begin{array}{l}\nq = {S_{11}} - {S_{21}}'S_{22}^{ - 1}{S_{21}}\\,\\,\\,\\,\\left( {1 \\times 1} \\right)\\\\\nr = S_{22}^{ - 1}{S_{21}}\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\left( {k \\times 1} \\right)\\\\\nR = {S_{22}}\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\left( {k \\times k} \\right)\n\\end{array}\\] Then \\[\\begin{array}{l}\n{S_{22}} = R\\\\\nS{{\\kern 1pt} _{12}} = Rr\\\\\n{S_{11}} = q + r'Rr\n\\end{array}\\] and \\[\\begin{array}{l}\nd{S_{11}} = dq + {\\text{terms in }}d{r_i}{\\text{ and }}d{R_{ij}}{\\text{'s}}\\\\\ndS{{\\kern 1pt} _{12}} = \\left| R \\right|dr + {\\text{terms in }}d{R_{ij}}{\\text{'s}}\\\\\nd{S_{22}} = \\left\\{ {d{R_{ij}}} \\right\\}\n\\end{array}\\] Putting things together, \\[\\begin{array}{c}\nd{S_{11}} \\wedge \\left( {d{S_{12}}} \\right) \\wedge \\left( {d{S_{22}}} \\right) = dq \\wedge \\left| R \\right|\\left( {dr} \\right) \\wedge \\left( {dR} \\right) + {\\text{all other terms that vanish}}\\\\\n= \\left| R \\right|dq \\wedge \\left( {dr} \\right) \\wedge \\left( {dR} \\right).\n\\end{array}\\] Here I have used \\[\\begin{array}{l}\n\\left( {dr} \\right) = d{r_1} \\wedge d{r_2} \\wedge ... \\wedge d{r_k} = \\mathop  \\wedge \\limits_{i = 1}^k d{r_i}\\\\\n\\left( {d{S_{12}}} \\right) = d{S_{12\\left( 1 \\right)}} \\wedge d{S_{12\\left( 2 \\right)}} \\wedge ... \\wedge d{S_{12\\left( k \\right)}} = \\mathop  \\wedge \\limits_{i = 1}^k d{S_{12\\left( i \\right)}}\\\\\n\\left( {dR} \\right) = \\left( {d{R_1}} \\right) \\wedge \\left( {d{R_2}} \\right) \\wedge ... \\wedge \\left( {d{R_k}} \\right)\\, = \\mathop  \\wedge \\limits_{i = 1}^k \\mathop  \\wedge \\limits_{j = 1}^k d{R_{ij}}\\,\\,\\,\\,{R_j} = j{\\text{ - th column of }}R\\\\\n\\left( {d{S_{22}}} \\right) = \\left( {d{S_{22\\left( 1 \\right)}}} \\right) \\wedge \\left( {d{S_{22\\left( 2 \\right)}}} \\right) \\wedge ... \\wedge \\left( {d{S_{22\\left( k \\right)}}} \\right) = \\mathop  \\wedge \\limits_{i = 1}^k \\mathop  \\wedge \\limits_{j = 1}^k d{S_{22\\left( {i,j} \\right)}}\\,\\,\\,\\,\\,{S_{22\\left( j \\right)}} = j{\\text{ - th column of }}{S_{22}}\n\\end{array}\\]"
  },
  {
    "objectID": "posts/CED4/index.html#the-exterior-product",
    "href": "posts/CED4/index.html#the-exterior-product",
    "title": "Computing exact distributions part 4",
    "section": "",
    "text": "It may be difficult to calculate Jacobians as the determinant of matrices of derivatives, especially when one has many variables. However, there is an alternative method based on the exterior product which may be useful in some cases. This approach is covered in this post.\nWhen one transforms \\(x\\) to \\(y\\) according to \\(x = x\\left( y \\right)\\), every component of \\(x\\) is transformed as follows \\({x_i} = {x_i}\\left( {{y_1},{y_2},...{y_n}} \\right)\\). So the differential of \\({x_i}\\) is \\[d{x_i} = \\frac{{\\partial {x_i}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_i}}}{{\\partial {y_2}}}d{y_2} + ... + \\frac{{\\partial {x_i}}}{{\\partial {y_n}}}d{y_n}\\] for i=1,2,…,n. I now consider the quantities \\(d{x_i}\\), i=1,2,…,n, and define a product (or more precisely the exterior product or wedge product) by two rules\n\nmultilinearity \\[d{x_i} \\wedge \\left( {ad{x_j} + bd{x_k}} \\right) = a\\left( {d{x_i} \\wedge d{x_j}} \\right) + b\\left( {d{x_i} \\wedge d{x_k}} \\right)\\] and \\[\\left( {ad{x_j} + bd{x_k}} \\right) \\wedge d{x_i} = a\\left( {d{x_j} \\wedge d{x_i}} \\right) + b\\left( {d{x_k} \\wedge d{x_i}} \\right)\\]\nand skew-symmetry \\[d{x_i} \\wedge d{x_j} =  - d{x_j} \\wedge d{x_i}\\] i.e. if the order of two terms is reversed, the product changes sign.\n\nNotice that when I write \\(d{x_1}d{x_2,}....d{x_n}\\) I really mean \\(d{x_1} \\wedge d{x_2} \\wedge .... \\wedge d{x_n}\\). If follows from the property of skew-symmetry that \\[d{x_i} \\wedge d{x_i} =  - d{x_i} \\wedge d{x_i}\\] i.e.\\(d{x_i} \\wedge d{x_i} = 0.\\)\nAn important result is the following one. If \\[d{x_i} = \\frac{{\\partial {x_i}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_i}}}{{\\partial {y_2}}}d{y_2} + ... + \\frac{{\\partial {x_i}}}{{\\partial {y_n}}}d{y_n}\\] for \\(i=1,2,…,n\\), and I let \\[d{x_1} \\wedge d{x_2} \\wedge d{x_3} \\wedge .... \\wedge d{x_n} = J\\left( {x \\to y} \\right)\\left( {d{y_1} \\wedge d{y_2} \\wedge d{y_3} \\wedge .... \\wedge d{y_n}} \\right),\\] so that this method is equivalent to the one considered before.\nI will not prove this, but I will go through an example instead. Suppose that \\(n=3\\), so that I need to deal with \\(d{x_1} \\wedge d{x_2} \\wedge d{x_3}\\) only, and \\[\\begin{array}{l}\nd{x_1} = \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}d{y_3}\\\\\nd{x_2} = \\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_3}\\\\\nd{x_3} = \\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}\n\\end{array}\\] Then \\[\\begin{array}{c}\nd{x_1} \\wedge d{x_2} \\wedge d{x_3} = \\left( {\\frac{{\\partial {x_1}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}d{y_3}} \\right) \\wedge \\\\\n\\left( {\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_3}} \\right) \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n= \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}d{y_1} \\wedge \\left( {\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_3}} \\right) \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}d{y_2} \\wedge \\left( {\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_3}} \\right) \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}d{y_3} \\wedge \\left( {\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_3}} \\right) \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\n\\end{array}\\] because of the property of multilinearity. \\[\\begin{array}{c}\nd{x_1} \\wedge d{x_2} \\wedge d{x_3} = \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_1} \\wedge d{y_1} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_1} \\wedge d{y_2} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_1} \\wedge d{y_3} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_2} \\wedge d{y_1} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_2} \\wedge d{y_2} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_2} \\wedge d{y_3} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_3} \\wedge d{y_1} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_3} \\wedge d{y_2} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_3} \\wedge d{y_3} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\n\\end{array}\\] Again, this follows from multilinearity. Notice that some terms are zero because \\(d{y_i} \\wedge d{y_i} = 0\\), \\[\\begin{array}{c}\nd{x_1} \\wedge d{x_2} \\wedge d{x_3} = \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_1} \\wedge d{y_2} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_1} \\wedge d{y_3} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_2} \\wedge d{y_1} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_2} \\wedge d{y_3} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_3} \\wedge d{y_1} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_3} \\wedge d{y_2} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\n\\end{array}\\]\nThings simplify even more. I will focus on the first term \\[\\begin{array}{l}\n\\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_1} \\wedge d{y_2} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right)\\\\\n= \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} \\wedge d{y_2} \\wedge d{y_1}\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_1} \\wedge d{y_2} \\wedge d{y_2}\\\\\n+ \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_1} \\wedge d{y_2} \\wedge d{y_3}\n\\end{array}\\]\nNow \\[d{y_1} \\wedge d{y_2} \\wedge d{y_1} =  - d{y_1} \\wedge d{y_1} \\wedge d{y_2}\\] because of skew-symmetry. But \\(d{y_1} \\wedge d{y_1} = 0\\), so that \\[d{y_1} \\wedge d{y_2} \\wedge d{y_1} =  - d{y_1} \\wedge d{y_1} \\wedge d{y_2} = 0.\\]\nIn general, if there are two terms which are the same the outer product is zero. So \\[\\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_1} \\wedge d{y_2} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right) = \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_1} \\wedge d{y_2} \\wedge d{y_3}.\\]\nUsing the same reasoning it is easy to show that \\[\\begin{array}{c}\n\\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_1} \\wedge d{y_3} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right) =  - \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}\\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_1} \\wedge d{y_3} \\wedge d{y_3}\\\\\n\\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_2} \\wedge d{y_1} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right) = \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}\\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_2} \\wedge d{y_1} \\wedge d{y_3}\\\\\n=  - \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}\\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_1} \\wedge d{y_2} \\wedge d{y_3}\\\\\n\\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}d{y_2} \\wedge d{y_3} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right) = \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} \\wedge d{y_2} \\wedge d{y_3}\\\\\n\\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}d{y_3} \\wedge d{y_1} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right) = \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}\\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_1} \\wedge d{y_2} \\wedge d{y_3}\\\\\n\\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}d{y_3} \\wedge d{y_2} \\wedge \\left( {\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} + \\frac{{\\partial {x_3}}}{{\\partial {y_2}}}d{y_2} + \\frac{{\\partial {x_3}}}{{\\partial {y_3}}}d{y_3}} \\right) = \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_3} \\wedge d{y_2} \\wedge d{y_1}\\\\\n=  - \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_3} \\wedge d{y_1} \\wedge d{y_2}\\\\\n= \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} \\wedge d{y_3} \\wedge d{y_2}\\\\\n=  - \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}d{y_1} \\wedge d{y_2} \\wedge d{y_3}\n\\end{array}\\]\nPutting everything together \\[\\begin{array}{l}\nd{x_1} \\wedge d{x_2} \\wedge d{x_3}\\\\\n= \\left[ {\\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_3}}} - \\frac{{\\partial {x_1}}}{{\\partial {y_1}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}\\frac{{\\partial {x_3}}}{{\\partial {y_3}}} - \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}\\frac{{\\partial {x_3}}}{{\\partial {y_3}}} + \\frac{{\\partial {x_1}}}{{\\partial {y_2}}}\\frac{{\\partial {x_2}}}{{\\partial {y_3}}}\\frac{{\\partial {x_3}}}{{\\partial {y_1}}} + \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_1}}}\\frac{{\\partial {x_3}}}{{\\partial {y_2}}} - \\frac{{\\partial {x_1}}}{{\\partial {y_3}}}\\frac{{\\partial {x_2}}}{{\\partial {y_2}}}\\frac{{\\partial {x_3}}}{{\\partial {y_1}}}} \\right]d{y_1} \\wedge d{y_2} \\wedge d{y_3}\n\\end{array}\\]\nThe complicated thing in square brackets is \\(J\\left( {x \\to y} \\right)\\). So \\[d{x_1} \\wedge d{x_2} \\wedge d{x_3} = J\\left( {x \\to y} \\right)d{y_1} \\wedge d{y_2} \\wedge d{y_3}.\\] This can be rewritten as \\[\\left( {dx} \\right) = J\\left( {x \\to y} \\right)\\left( {dy} \\right)\\] where \\(\\left( {dx} \\right) = d{x_1} \\wedge d{x_2} \\wedge d{x_3}\\) and \\(\\left( {dy} \\right) = d{y_1} \\wedge d{y_2} \\wedge d{y_3}\\). Sometimes the notation \\(d{x_1} \\wedge d{x_2} \\wedge d{x_3} \\wedge ... \\wedge d{x_n} = \\mathop \\wedge \\limits_{i = 1}^n d{x_i}\\) is used. The quantity \\(\\left( {dx} \\right) = \\mathop \\wedge \\limits_{i = 1}^n d{x_i}\\) is called the volume element.\nExample 1. Let \\({q_1}\\sim{\\chi ^2}\\left( {{v_1}} \\right)\\) and \\({q_2}\\sim{\\chi ^2}\\left( {{v_2}} \\right)\\) be independent random variables. Suppose I transform variables as \\({q_1} = fq\\) and \\({q_2} = q\\) (i.e. \\(f = {q_1}/{q_2}\\)). What is the Jacobian of this transformation? To find it, I need to calculate the differentials \\[\\begin{array}{l}\nd{q_1} = qdf + fdq\\\\\nd{q_2} = dq\n\\end{array}\\] so \\[d{q_1} \\wedge d{q_2} = \\left( {qdf + fdq} \\right) \\wedge dq = q\\left( {df \\wedge dq} \\right).\\]\nExercise 2. Let \\(x\\) be an \\(n \\times 1\\) vector then I denote \\[\\left( {dx} \\right) = d{x_1} \\wedge d{x_2} \\wedge d{x_3} \\wedge ... \\wedge d{x_n} = \\mathop  \\wedge \\limits_{i = 1}^n d{x_i}\\] (note the order of the elements of the product). Suppose I set \\(x = Ay\\) where \\(A\\) is an \\(n \\times n\\) non-singular matrix. Then, I have \\(\\left( {dx} \\right) = \\left| A \\right|\\left( {dy} \\right)\\).\nExample 3. Let \\(S &gt; 0\\) be a positve definite matrix of dimension \\((k + 1 \\times k + 1)\\). Partition is as \\[S = \\left( {\\begin{array}{*{20}{c}}\n{{S_{11}}}&{{S_{21}}'}\\\\\n{{S_{21}}}&{{S_{22}}}\n\\end{array}} \\right)\\] where \\({S_{11}}\\) is \\(1 \\times 1\\), \\({S_{22}}\\) is \\(k \\times k\\) and \\({S_{21}}\\) is \\(k \\times 1\\). Let \\[\\begin{array}{l}\nq = {S_{11}} - {S_{21}}'S_{22}^{ - 1}{S_{21}}\\,\\,\\,\\,\\left( {1 \\times 1} \\right)\\\\\nr = S_{22}^{ - 1}{S_{21}}\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\left( {k \\times 1} \\right)\\\\\nR = {S_{22}}\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\left( {k \\times k} \\right)\n\\end{array}\\] Then \\[\\begin{array}{l}\n{S_{22}} = R\\\\\nS{{\\kern 1pt} _{12}} = Rr\\\\\n{S_{11}} = q + r'Rr\n\\end{array}\\] and \\[\\begin{array}{l}\nd{S_{11}} = dq + {\\text{terms in }}d{r_i}{\\text{ and }}d{R_{ij}}{\\text{'s}}\\\\\ndS{{\\kern 1pt} _{12}} = \\left| R \\right|dr + {\\text{terms in }}d{R_{ij}}{\\text{'s}}\\\\\nd{S_{22}} = \\left\\{ {d{R_{ij}}} \\right\\}\n\\end{array}\\] Putting things together, \\[\\begin{array}{c}\nd{S_{11}} \\wedge \\left( {d{S_{12}}} \\right) \\wedge \\left( {d{S_{22}}} \\right) = dq \\wedge \\left| R \\right|\\left( {dr} \\right) \\wedge \\left( {dR} \\right) + {\\text{all other terms that vanish}}\\\\\n= \\left| R \\right|dq \\wedge \\left( {dr} \\right) \\wedge \\left( {dR} \\right).\n\\end{array}\\] Here I have used \\[\\begin{array}{l}\n\\left( {dr} \\right) = d{r_1} \\wedge d{r_2} \\wedge ... \\wedge d{r_k} = \\mathop  \\wedge \\limits_{i = 1}^k d{r_i}\\\\\n\\left( {d{S_{12}}} \\right) = d{S_{12\\left( 1 \\right)}} \\wedge d{S_{12\\left( 2 \\right)}} \\wedge ... \\wedge d{S_{12\\left( k \\right)}} = \\mathop  \\wedge \\limits_{i = 1}^k d{S_{12\\left( i \\right)}}\\\\\n\\left( {dR} \\right) = \\left( {d{R_1}} \\right) \\wedge \\left( {d{R_2}} \\right) \\wedge ... \\wedge \\left( {d{R_k}} \\right)\\, = \\mathop  \\wedge \\limits_{i = 1}^k \\mathop  \\wedge \\limits_{j = 1}^k d{R_{ij}}\\,\\,\\,\\,{R_j} = j{\\text{ - th column of }}R\\\\\n\\left( {d{S_{22}}} \\right) = \\left( {d{S_{22\\left( 1 \\right)}}} \\right) \\wedge \\left( {d{S_{22\\left( 2 \\right)}}} \\right) \\wedge ... \\wedge \\left( {d{S_{22\\left( k \\right)}}} \\right) = \\mathop  \\wedge \\limits_{i = 1}^k \\mathop  \\wedge \\limits_{j = 1}^k d{S_{22\\left( {i,j} \\right)}}\\,\\,\\,\\,\\,{S_{22\\left( j \\right)}} = j{\\text{ - th column of }}{S_{22}}\n\\end{array}\\]"
  }
]